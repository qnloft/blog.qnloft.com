---
import { Icon } from "astro-icon/components";
import { siteConfig } from "../../config";
import ImageWrapper from "../misc/ImageWrapper.astro";

interface Props {
	class?: string;
	style?: string;
}

const { class: className, style } = Astro.props;
const adsConfig = siteConfig.ads;
---

{adsConfig.enable && (
	<div class:list={["ad-banner-container", className]} style={style}>
		{adsConfig.ads.filter(ad => ad.show).map((ad) => (
			<div class="card-base p-4 mb-4 rounded-[var(--radius-large)] overflow-hidden relative group">
				<!-- 广告标识 -->
				<div class="absolute top-2 right-2 z-10 bg-black/10 dark:bg-white/10 text-black/50 dark:text-white/50 px-2 py-1 rounded text-xs">
					广告
				</div>
				
				<!-- 广告图片 -->
				<div class="relative mb-3 rounded-lg overflow-hidden">
					<a 
						href={ad.link} 
						target="_blank" 
						rel="noopener noreferrer"
						class="block w-full h-full cursor-pointer"
					>
						<ImageWrapper 
							src={ad.image} 
							alt={ad.title}
							class="w-full h-32 object-cover group-hover:scale-105 transition-transform duration-300"
						/>
						<div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-colors duration-300"></div>
					</a>
				</div>
				
				<!-- 广告内容 -->
				<div class="space-y-2">
					<h3 class="font-bold text-lg text-black/90 dark:text-white/90">
						<a 
							href={ad.link} 
							target="_blank" 
							rel="noopener noreferrer"
							class="hover:text-[var(--primary)] transition-colors duration-200 cursor-pointer"
						>
							{ad.title}
						</a>
					</h3>
					<p class="text-sm text-black/70 dark:text-white/70 overflow-hidden text-ellipsis display-webkit-box -webkit-line-clamp-2 -webkit-box-orient-vertical">
						{ad.description}
					</p>
					
					<!-- 广告按钮 -->
					{ad.buttonText && ad.buttonText.trim() !== "" && (
						<a 
							href={ad.link} 
							target="_blank" 
							rel="noopener noreferrer"
							class="inline-flex items-center gap-2 bg-[var(--primary)] text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-[var(--primary-hover)] active:scale-95 transition-all duration-200"
						>
							{ad.buttonText}
							<Icon name="material-symbols:arrow-forward" class="text-sm"></Icon>
						</a>
					)}
				</div>
			</div>
		))}
	</div>
)}

<style>
	.ad-banner-container {
		width: 100%;
	}
	
	/* 侧边栏广告样式 */
	.ad-banner-container .card-base {
		margin-bottom: 1rem;
	}
	
	.ad-banner-container .card-base:last-child {
		margin-bottom: 0;
	}
</style>
